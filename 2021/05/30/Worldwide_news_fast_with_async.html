<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Did you hear the news? | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Did you hear the news?" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://hugocool.github.io/blog/2021/05/30/Worldwide_news_fast_with_async.html" />
<meta property="og:url" content="https://hugocool.github.io/blog/2021/05/30/Worldwide_news_fast_with_async.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-30T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"An easy to use blogging platform with support for Jupyter Notebooks.","url":"https://hugocool.github.io/blog/2021/05/30/Worldwide_news_fast_with_async.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hugocool.github.io/blog/2021/05/30/Worldwide_news_fast_with_async.html"},"headline":"Did you hear the news?","dateModified":"2021-05-30T00:00:00-05:00","datePublished":"2021-05-30T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://hugocool.github.io/blog/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Did you hear the news?</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-30T00:00:00-05:00" itemprop="datePublished">
        May 30, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      24 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/hugocool/blog/tree/master/_notebooks/Worldwide_news_fast_with_async.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/hugocool/blog/master?filepath=_notebooks%2FWorldwide_news_fast_with_async.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/hugocool/blog/blob/master/_notebooks/Worldwide_news_fast_with_async.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/Worldwide_news_fast_with_async.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Follow-a-news-topic-all-over-the-world-in-your-native-language.">Follow a news topic all over the world in your native language.<a class="anchor-link" href="#Follow-a-news-topic-all-over-the-world-in-your-native-language."> </a></h1><blockquote><p>We'll take some keywords, translate them into different language, fetch the news on these keywords and translate the new back. First we make it work, then make it fast using three layers of async programming</p>
</blockquote>
<ul>
<li>author :Hugo Evers</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="2f2e2923-e3f7-4433-829b-351b9d688ac9" class="plotly-graph-div" style="height:550px; width:800px;"></div>
            <script type="text/javascript">
                
                    window.PLOTLYENV=window.PLOTLYENV || {};
                    
                if (document.getElementById("2f2e2923-e3f7-4433-829b-351b9d688ac9")) {
                    Plotly.newPlot(
                        '2f2e2923-e3f7-4433-829b-351b9d688ac9',
                        [{"cells": {"align": "left", "fill": {"color": "rgba(0,0,0,0)"}, "font": {"color": ["#72bf44", "#414141", "#313c59"], "family": "Verdana", "size": [10, 12]}, "height": 40, "values": [["29-May", "27-May", "27-May", "27-May", "25-May", "24-May", "24-May", "24-May"], ["<b><b>\"Groningen Airport Eelde also looks at Brussels for chances of survival. Funds of European Union can help indirectly \"</b> </b> Funds of the European Union can indirectly help in the survival of Groningen Airport Eelde (GAE). The airport therefore focused on brussels. ...  <a href=\"https://www.dvhn.nl/drenthe/Groningen-Airport-Eelde-kijkt-ook-naar-Brussel-voor-overlevingskansen-26854246.html\">Link</a>", "<b><b>\"Thanks to private jet, make more flights thanks to private jet than the mortal \"</b> </b> The market for private flights in Europe has recovered faster from the coronacrisis than the 'ordinary' aviation. While Jan are modal ...  <a href=\"https://www.volkskrant.nl/nieuws-achtergrond/superrijken-maken-dankzij-privejet-al-weer-meer-vluchten-dan-de-sterveling~b40828a1/\">Link</a>", "<b><b>\"Consumers' Association: Transavia 'least flexible' airline \"</b> </b> Whoever wants to book a flexible flight ticket for the summer holidays cannot turn to Transavia. Compared to other European airlines, it is a lot less flexible as H ...  <a href=\"https://www.msn.com/nl-nl/news/Binnenland/consumentenbond-transavia-minst-flexibele-vliegmaatschappij/ar-AAKqSMa\">Link</a>", "<b><b>\"Ryanair pays people to get on the plane is pure marketing \"</b> </b> There is a lot of misunderstanding with the general public about aviation, so it turns out again. Readers reported to me that the KLM remained before the hijack of a device from Ryanair above Belarus v ...  <a href=\"https://www.telegraaf.nl/watuzegt/1752348247/ryanair-betaalt-mensen-om-in-het-vliegtuig-te-stappen-is-pure-marketingstunt\">Link</a>", "<b><b>\"KLM continues to fly over Belarus, other companies not \"</b> </b> Airline KLM continues to fly through the Belarusian airspace. Society says no safety risk and states that the flight schedule \"will be continued normally\". KLM has ...  <a href=\"https://www.rd.nl/artikel/928503-klm-blijft-over-wit-rusland-vliegen\">Link</a>", "<b><b>\"KLM still stops flights above Belarus \"</b> </b> KLM is still going to fly Belarus on routes from and to Asia. That lets society know after Remissionary Prime Minister Rutte KLM called to avoid white-russian airspace. The reason is D ...  <a href=\"https://www.nhnieuws.nl/nieuws/286261/klm-stopt-toch-met-vluchten-boven-wit-rusland\">Link</a>", "<b><b>\"KLM stops flying about Belarus after call Prime Minister Rutte \"</b> </b> KLM does not fly over the airspace of Belarus for the time being. Prime Minister Rutte Rutte raised the airline earlier on Monday ...  <a href=\"https://www.volkskrant.nl/nieuws-achtergrond/klm-stopt-met-vliegen-over-belarus-na-oproep-premier-rutte~b66d8a01/\">Link</a>", "<b><b>\"KLM remains flying about Belarus, other companies not \"</b> </b> Airline KLM remains flying through the airspace over Belarus. Various other companies avoid the country for the time being ...  <a href=\"https://www.parool.nl/wereld/klm-blijft-over-belarus-vliegen-andere-maatschappijen-niet~b9bc387b/\">Link</a>"]]}, "columnwidth": [1.4, 8], "header": {"fill": {"color": "rgba(0,0,0,0)"}, "font": {"color": "#414141", "family": "Verdana", "size": 12}, "height": 0, "values": [[""], [""]]}, "type": "table"}],
                        {"autosize": true, "height": 550, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"font": {"color": "#414141", "family": "Verdana", "size": 18}, "text": "<b>Latest Aviation news</b>", "x": 0.5}, "width": 800},
                        {"displayModeBar": false, "responsive": true}
                    ).then(function(){
                            
var gd = document.getElementById('2f2e2923-e3f7-4433-829b-351b9d688ac9');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                
            </script>
        </div>
</body>
</html>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>url</th>
      <th>description</th>
      <th>provider</th>
      <th>market</th>
    </tr>
    <tr>
      <th>datePublished</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-05-27 13:00:00+00:00</th>
      <td>Superrijken maken dankzij privéjet al weer mee...</td>
      <td>https://www.volkskrant.nl/nieuws-achtergrond/s...</td>
      <td>De markt voor privévluchten in Europa heeft zi...</td>
      <td>Volkskrant</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-27 09:05:14+00:00</th>
      <td>Consumentenbond: Transavia 'minst flexibele' v...</td>
      <td>https://www.msn.com/nl-nl/news/Binnenland/cons...</td>
      <td>Wie voor de zomervakantie een flexibel vliegti...</td>
      <td>RTL Nieuws on MSN.com</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-24 14:10:00+00:00</th>
      <td>KLM stopt met vliegen over Belarus na oproep p...</td>
      <td>https://www.volkskrant.nl/nieuws-achtergrond/k...</td>
      <td>KLM vliegt voorlopig niet over het luchtruim v...</td>
      <td>Volkskrant</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-29 05:02:00+00:00</th>
      <td>Groningen Airport Eelde kijkt ook naar Brussel...</td>
      <td>https://www.dvhn.nl/drenthe/Groningen-Airport-...</td>
      <td>Fondsen van de Europese Unie kunnen indirect h...</td>
      <td>DVHN</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-27 05:45:00+00:00</th>
      <td>Ryanair betaalt mensen om in het vliegtuig te ...</td>
      <td>https://www.telegraaf.nl/watuzegt/1752348247/r...</td>
      <td>Er is veel onbegrip bij het grote publiek over...</td>
      <td>De Telegraaf</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-25 06:57:00+00:00</th>
      <td>KLM blijft over Wit-Rusland vliegen, andere ma...</td>
      <td>https://www.rd.nl/artikel/928503-klm-blijft-ov...</td>
      <td>Luchtvaartmaatschappij KLM blijft door het Wit...</td>
      <td>RD</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-24 19:30:00+00:00</th>
      <td>KLM stopt toch met vluchten boven Wit-Rusland</td>
      <td>https://www.nhnieuws.nl/nieuws/286261/klm-stop...</td>
      <td>KLM gaat toch om Wit-Rusland vliegen op routes...</td>
      <td>Nieuws</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>2021-05-24 11:07:00+00:00</th>
      <td>KLM blijft over Belarus vliegen, andere maatsc...</td>
      <td>https://www.parool.nl/wereld/klm-blijft-over-b...</td>
      <td>Luchtvaartmaatschappij KLM blijft door het luc...</td>
      <td>PAROOL</td>
      <td>nl-NL</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>

<span class="k">def</span> <span class="nf">news_table</span><span class="p">(</span><span class="n">dates</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
               <span class="n">titles</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
               <span class="n">summaries</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
               <span class="n">urls</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
               <span class="n">autosize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
               <span class="n">height</span><span class="o">=</span><span class="mi">550</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span>

  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">date</span><span class="p">:</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b&#39;</span><span class="p">),</span><span class="n">dates</span><span class="p">))</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">url</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;a href=&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&quot;&gt;Link&lt;/a&gt;&#39;</span><span class="p">,</span> <span class="n">urls</span><span class="p">))</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">url</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;b&gt;&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s1">&quot;&lt;/b&gt; &#39;</span><span class="p">,</span> <span class="n">titles</span><span class="p">))</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&lt;b&gt;&#39;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&lt;/b&gt; &#39;</span> <span class="o">+</span> <span class="n">summaries</span> <span class="o">+</span> <span class="s1">&#39;...  &#39;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;URL&#39;</span><span class="p">]</span>

  <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Text&#39;</span><span class="p">]]</span>
  <span class="n">text_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#72bf44&#39;</span><span class="p">,</span> <span class="s1">&#39;#414141&#39;</span><span class="p">,</span> <span class="s1">&#39;#313c59&#39;</span><span class="p">]</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
      <span class="n">columnwidth</span><span class="o">=</span><span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
      <span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
                          <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]],</span>
                  <span class="n">fill_color</span><span class="o">=</span><span class="s1">&#39;rgba(0,0,0,0)&#39;</span><span class="p">,</span>
                  <span class="c1"># align=&#39;left&#39;,</span>
                  <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#414141&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Verdana&#39;</span><span class="p">),</span>
                  <span class="n">height</span><span class="o">=</span><span class="mi">0</span>
                  <span class="p">),</span>
      <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                  <span class="n">fill_color</span><span class="o">=</span><span class="s1">&#39;rgba(0,0,0,0)&#39;</span><span class="p">,</span>
                  <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                  <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">text_colors</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Verdana&#39;</span><span class="p">),</span>
                  <span class="n">height</span><span class="o">=</span><span class="mi">40</span>
                  <span class="p">))</span>
  <span class="p">])</span>

  <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
      <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;&lt;b&gt;Latest Aviation news&lt;/b&gt;&#39;</span><span class="p">,</span>
                  <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#414141&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Verdana&#39;</span><span class="p">)),</span>
      <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
      <span class="n">autosize</span><span class="o">=</span><span class="n">autosize</span><span class="p">,</span>
      <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
      <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
  <span class="p">)</span>
  <span class="k">return</span> <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;displayModeBar&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="bing-news">bing news<a class="anchor-link" href="#bing-news"> </a></h1><p>get the news data as a dataframe</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_keywords_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">markets_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">market_keywords_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country/Region</th>
      <th>Language</th>
      <th>iso_alpha</th>
      <th>keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>da-DK</th>
      <td>Denmark</td>
      <td>Danish</td>
      <td>DNK</td>
      <td>Luftfart Flyselskab Fly Lufthavn Plane</td>
    </tr>
    <tr>
      <th>de-AT</th>
      <td>Austria</td>
      <td>German</td>
      <td>AUT</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>de-CH</th>
      <td>Switzerland</td>
      <td>German</td>
      <td>CHE</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>de-DE</th>
      <td>Germany</td>
      <td>German</td>
      <td>DEU</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>en-AU</th>
      <td>Australia</td>
      <td>English</td>
      <td>AUS</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-CA</th>
      <td>Canada</td>
      <td>English</td>
      <td>CAN</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-GB</th>
      <td>United Kingdom</td>
      <td>English</td>
      <td>GBR</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-ID</th>
      <td>Indonesia</td>
      <td>English</td>
      <td>IDN</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-IE</th>
      <td>Ireland</td>
      <td>English</td>
      <td>IRL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-IN</th>
      <td>India</td>
      <td>English</td>
      <td>IND</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-MY</th>
      <td>Malaysia</td>
      <td>English</td>
      <td>MYS</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-NZ</th>
      <td>New Zealand</td>
      <td>English</td>
      <td>NZL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-PH</th>
      <td>Republic of the Philippines</td>
      <td>English</td>
      <td>PHL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-SG</th>
      <td>Singapore</td>
      <td>English</td>
      <td>SGP</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-US</th>
      <td>United States</td>
      <td>English</td>
      <td>USA</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-ZA</th>
      <td>South Africa</td>
      <td>English</td>
      <td>ZAF</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>es-AR</th>
      <td>Argentina</td>
      <td>Spanish</td>
      <td>ARG</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-CL</th>
      <td>Chile</td>
      <td>Spanish</td>
      <td>CHL</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-ES</th>
      <td>Spain</td>
      <td>Spanish</td>
      <td>ESP</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-MX</th>
      <td>Mexico</td>
      <td>Spanish</td>
      <td>MEX</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>fi-FI</th>
      <td>Finland</td>
      <td>Finnish</td>
      <td>FIN</td>
      <td>ilmailu lentoyhtiö lennot Lentokenttä kone</td>
    </tr>
    <tr>
      <th>fr-FR</th>
      <td>France</td>
      <td>French</td>
      <td>FRA</td>
      <td>Aviation Compagnie aérienne Vols Aéroport Avion</td>
    </tr>
    <tr>
      <th>it-IT</th>
      <td>Italy</td>
      <td>Italian</td>
      <td>ITA</td>
      <td>aviazione linea aerea voli Aeroporto Aereo</td>
    </tr>
    <tr>
      <th>ja-JP</th>
      <td>Japan</td>
      <td>Japanese</td>
      <td>JPN</td>
      <td>航空 エアライン フライト 空港 飛行機</td>
    </tr>
    <tr>
      <th>ko-KR</th>
      <td>Korea</td>
      <td>Korean</td>
      <td>KOR</td>
      <td>비행 공기 호스 항공편 공항 비행기</td>
    </tr>
    <tr>
      <th>nl-BE</th>
      <td>Belgium</td>
      <td>Dutch</td>
      <td>BEL</td>
      <td>Luchtvaart vliegmaatschappij Vluchten Luchthav...</td>
    </tr>
    <tr>
      <th>nl-NL</th>
      <td>Netherlands</td>
      <td>Dutch</td>
      <td>NLD</td>
      <td>Luchtvaart vliegmaatschappij Vluchten Luchthav...</td>
    </tr>
    <tr>
      <th>pl-PL</th>
      <td>Poland</td>
      <td>Polish</td>
      <td>POL</td>
      <td>Lotnictwo Linia lotnicza Loty Lotnisko Samolot</td>
    </tr>
    <tr>
      <th>pt-BR</th>
      <td>Brazil</td>
      <td>Portuguese</td>
      <td>BRA</td>
      <td>Aviação CIA aérea Voos Aeroporto Avião</td>
    </tr>
    <tr>
      <th>ru-RU</th>
      <td>Russia</td>
      <td>Russian</td>
      <td>RUS</td>
      <td>авиации авиакомпания рейсы аэропорт Плане</td>
    </tr>
    <tr>
      <th>sv-SE</th>
      <td>Sweden</td>
      <td>Swedish</td>
      <td>SWE</td>
      <td>Flyg Flygbolag Flyg Flygplats Plan</td>
    </tr>
    <tr>
      <th>tr-TR</th>
      <td>Turkey</td>
      <td>Turkish</td>
      <td>TUR</td>
      <td>Havacılık Havayolu Uçak Havalimanı uçak</td>
    </tr>
    <tr>
      <th>zh-CN</th>
      <td>People's republic of China</td>
      <td>Chinese (simplified)</td>
      <td>CHN</td>
      <td>航空 航空公司 机票 飞机场 平面</td>
    </tr>
    <tr>
      <th>zh-HK</th>
      <td>Hong Kong SAR</td>
      <td>Chinese (traditional)</td>
      <td>HKG</td>
      <td>航空 航空公司 機票 飛機場 平面</td>
    </tr>
    <tr>
      <th>zh-TW</th>
      <td>Taiwan</td>
      <td>Chinese (traditional)</td>
      <td>TWN</td>
      <td>航空 航空公司 機票 飛機場 平面</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-create-the-queries-for-the-news-api?">How to create the queries for the news api?<a class="anchor-link" href="#How-to-create-the-queries-for-the-news-api?"> </a></h2><p>First follow the documentation over at bing, create an account, activate billing and setup an API key.
Then you need to create the query for the API request.
Which consist of:</p>
<ul>
<li>Market codes</li>
<li>Keywords (one string, keywords separated by spaces)</li>
<li>freshness</li>
<li>count</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">mkt</span> <span class="o">=</span> <span class="s1">&#39;nl-NL&#39;</span>
<span class="n">keywords</span> <span class="o">=</span> <span class="s1">&#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;</span>
<span class="n">search_url</span> <span class="o">=</span> <span class="s2">&quot;https://api.cognitive.microsoft.com/bing/v7.0/news/search&quot;</span>
<span class="n">freshness</span> <span class="o">=</span> <span class="s1">&#39;Week&#39;</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ocp-Apim-Subscription-Key&quot;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;BINGS_NEWS_API_KEY&#39;</span><span class="p">]}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">,</span>
    <span class="s1">&#39;freshness&#39;</span><span class="p">:</span> <span class="n">freshness</span><span class="p">,</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;mkt&#39;</span><span class="p">:</span> <span class="n">mkt</span><span class="p">,</span>
    <span class="c1"># &quot;textDecorations&quot;: True, &quot;textFormat&quot;: &quot;RAW&quot;</span>
<span class="p">}</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;_type&#39;: &#39;News&#39;,
 &#39;queryContext&#39;: {&#39;adultIntent&#39;: False,
  &#39;originalQuery&#39;: &#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;},
 &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/news/search?q=Luchtvaart+vliegmaatschappij+Vluchten+Luchthaven+Vliegtuig&#39;,
 &#39;sort&#39;: [{&#39;id&#39;: &#39;relevance&#39;,
   &#39;isSelected&#39;: True,
   &#39;name&#39;: &#39;Beste overeenkomst&#39;,
   &#39;url&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/news/search?q=Luchtvaart+vliegmaatschappij+Vluchten+Luchthaven+Vliegtuig&#39;},
  {&#39;id&#39;: &#39;date&#39;,
   &#39;isSelected&#39;: False,
   &#39;name&#39;: &#39;Meest recent&#39;,
   &#39;url&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/news/search?q=Luchtvaart+vliegmaatschappij+Vluchten+Luchthaven+Vliegtuig&amp;sortby=date&#39;}],
 &#39;totalEstimatedMatches&#39;: 8,
 &#39;value&#39;: [{&#39;about&#39;: [{&#39;name&#39;: &#39;de Volkskrant&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/a3b315b7-0c7d-d2d2-d2e6-c4d0e7964834&#39;}],
   &#39;category&#39;: &#39;Business&#39;,
   &#39;datePublished&#39;: &#39;2021-05-27T13:00:00.0000000Z&#39;,
   &#39;description&#39;: &#39;De markt voor privévluchten in Europa heeft zich sneller hersteld van de coronacrisis dan de ‘gewone’ luchtvaart. Terwijl Jan Modaal zijn&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.oJy735r2Aafw8ieaksZMGi&amp;pid=News&#39;,
     &#39;height&#39;: 466,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;Superrijken maken dankzij privéjet al weer meer vluchten dan de sterveling&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;Volkskrant&#39;}],
   &#39;url&#39;: &#39;https://www.volkskrant.nl/nieuws-achtergrond/superrijken-maken-dankzij-privejet-al-weer-meer-vluchten-dan-de-sterveling~b40828a1/&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;Consumentenbond&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/fea22130-578e-4ad9-9174-6a90720745fd&#39;}],
   &#39;category&#39;: &#39;Business&#39;,
   &#39;datePublished&#39;: &#39;2021-05-27T09:05:14.0000000Z&#39;,
   &#39;description&#39;: &#39;Wie voor de zomervakantie een flexibel vliegticket wil boeken, kan beter niet bij Transavia aankloppen. In vergelijking met andere Europese luchtvaartmaatschappijen is die een stuk minder soepel als h&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.OTQ5ataMdKakSebtaH5UXy&amp;pid=News&#39;,
     &#39;height&#39;: 393,
     &#39;width&#39;: 700}},
   &#39;mentions&#39;: [{&#39;name&#39;: &#39;Consumentenbond&#39;},
    {&#39;name&#39;: &#39;Transavia.com&#39;},
    {&#39;name&#39;: &#39;RTL Nieuws&#39;}],
   &#39;name&#39;: &#34;Consumentenbond: Transavia &#39;minst flexibele&#39; vliegmaatschappij&#34;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;RTL Nieuws on MSN.com&#39;}],
   &#39;url&#39;: &#39;https://www.msn.com/nl-nl/news/Binnenland/consumentenbond-transavia-minst-flexibele-vliegmaatschappij/ar-AAKqSMa&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;de Volkskrant&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/a3b315b7-0c7d-d2d2-d2e6-c4d0e7964834&#39;},
    {&#39;name&#39;: &#39;KLM&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/500f9f4f-16e3-a317-4cec-21fc8c627782&#39;},
    {&#39;name&#39;: &#39;Belarus&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/70f0e4f4-4cfb-8ee3-cfe6-041ba6b221bc&#39;}],
   &#39;datePublished&#39;: &#39;2021-05-24T14:10:00.0000000Z&#39;,
   &#39;description&#39;: &#39;KLM vliegt voorlopig niet over het luchtruim van Belarus. Eerder op maandag riep premier Rutte de luchtvaartmaatschappij op het luchtruim te&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.LwWrklLNGJl5oDHV9C4CmC&amp;pid=News&#39;,
     &#39;height&#39;: 469,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;KLM stopt met vliegen over Belarus na oproep premier Rutte&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;Volkskrant&#39;}],
   &#39;url&#39;: &#39;https://www.volkskrant.nl/nieuws-achtergrond/klm-stopt-met-vliegen-over-belarus-na-oproep-premier-rutte~b66d8a01/&#39;},
  {&#39;datePublished&#39;: &#39;2021-05-29T05:02:00.0000000Z&#39;,
   &#39;description&#39;: &#39;Fondsen van de Europese Unie kunnen indirect helpen bij het overleven van Groningen Airport Eelde (GAE). De luchthaven heeft dan ook de blik op Brussel gericht.&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.ilHo9N2ArAu9IBZzxo4fiy&amp;pid=News&#39;,
     &#39;height&#39;: 436,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;Groningen Airport Eelde kijkt ook naar Brussel voor overlevingskansen. Fondsen van Europese Unie kunnen indirect helpen&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;DVHN&#39;}],
   &#39;url&#39;: &#39;https://www.dvhn.nl/drenthe/Groningen-Airport-Eelde-kijkt-ook-naar-Brussel-voor-overlevingskansen-26854246.html&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;De Telegraaf&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/9d35a5f9-d594-d398-1e17-b30ade9d7385&#39;},
    {&#39;name&#39;: &#39;Ryanair&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/416c0ed4-d041-d9d6-4ddb-0d5c65f5be34&#39;}],
   &#39;datePublished&#39;: &#39;2021-05-27T05:45:00.0000000Z&#39;,
   &#39;description&#39;: &#39;Er is veel onbegrip bij het grote publiek over de luchtvaart, zo blijkt deze dagen weer. Lezers meldden mij verontwaardigd dat de KLM na de kaping van een toestel van Ryanair boven Wit-Rusland bleef v&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.b9W7s5HCwbJxAQWXNLl3bi&amp;pid=News&#39;,
     &#39;height&#39;: 367,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;Ryanair betaalt mensen om in het vliegtuig te stappen is pure marketingstunt&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;De Telegraaf&#39;}],
   &#39;url&#39;: &#39;https://www.telegraaf.nl/watuzegt/1752348247/ryanair-betaalt-mensen-om-in-het-vliegtuig-te-stappen-is-pure-marketingstunt&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;KLM&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/500f9f4f-16e3-a317-4cec-21fc8c627782&#39;},
    {&#39;name&#39;: &#39;Rusland, Cumbria&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/54cf54dd-77eb-3e02-afb1-7edb875e5941&#39;}],
   &#39;datePublished&#39;: &#39;2021-05-25T06:57:00.0000000Z&#39;,
   &#39;description&#39;: &#39;Luchtvaartmaatschappij KLM blijft door het Wit-Russische luchtruim vliegen. De maatschappij zegt geen veiligheidsrisico te zien en stelt dat het vluchtschema „normaal zal worden voortgezet”. KLM heeft&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.lpwGdQd6RSUjqsK_Q3ebPi&amp;pid=News&#39;,
     &#39;height&#39;: 437,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;KLM blijft over Wit-Rusland vliegen, andere maatschappijen niet&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;RD&#39;}],
   &#39;url&#39;: &#39;https://www.rd.nl/artikel/928503-klm-blijft-over-wit-rusland-vliegen&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;Rusland, Cumbria&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/54cf54dd-77eb-3e02-afb1-7edb875e5941&#39;},
    {&#39;name&#39;: &#39;New Hampshire&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/9ca71997-cc97-46eb-8911-fac32f80b0b1&#39;},
    {&#39;name&#39;: &#39;KLM&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/500f9f4f-16e3-a317-4cec-21fc8c627782&#39;}],
   &#39;datePublished&#39;: &#39;2021-05-24T19:30:00.0000000Z&#39;,
   &#39;description&#39;: &#39;KLM gaat toch om Wit-Rusland vliegen op routes van en naar Azië. Dat laat de maatschappij weten nadat demissionair premier Rutte KLM opriep om het Wit-Russische luchtruim te vermijden. Aanleiding is d&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.3o1T08dkW4JbTPzPE7GjnC&amp;pid=News&#39;,
     &#39;height&#39;: 394,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;KLM stopt toch met vluchten boven Wit-Rusland&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;Nieuws&#39;}],
   &#39;url&#39;: &#39;https://www.nhnieuws.nl/nieuws/286261/klm-stopt-toch-met-vluchten-boven-wit-rusland&#39;},
  {&#39;about&#39;: [{&#39;name&#39;: &#39;Belarus&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/70f0e4f4-4cfb-8ee3-cfe6-041ba6b221bc&#39;},
    {&#39;name&#39;: &#39;KLM&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/500f9f4f-16e3-a317-4cec-21fc8c627782&#39;},
    {&#39;name&#39;: &#39;Het Parool&#39;,
     &#39;readLink&#39;: &#39;https://api.cognitive.microsoft.com/api/v7/entities/914c006b-8523-333d-5ffc-2a81413ff871&#39;}],
   &#39;datePublished&#39;: &#39;2021-05-24T11:07:00.0000000Z&#39;,
   &#39;description&#39;: &#39;Luchtvaartmaatschappij KLM blijft door het luchtruim boven Belarus vliegen. Verschillende andere maatschappijen mijden het land voorlopig vanwege&#39;,
   &#39;image&#39;: {&#39;thumbnail&#39;: {&#39;contentUrl&#39;: &#39;https://www.bing.com/th?id=OVFT.rgCSEJM00FvWDGpT3PUFBS&amp;pid=News&#39;,
     &#39;height&#39;: 466,
     &#39;width&#39;: 700}},
   &#39;name&#39;: &#39;KLM blijft over Belarus vliegen, andere maatschappijen niet&#39;,
   &#39;provider&#39;: [{&#39;_type&#39;: &#39;Organization&#39;, &#39;name&#39;: &#39;PAROOL&#39;}],
   &#39;url&#39;: &#39;https://www.parool.nl/wereld/klm-blijft-over-belarus-vliegen-andere-maatschappijen-niet~b9bc387b/&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Our</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">keywords</span> <span class="n">to</span> <span class="n">search</span> <span class="k">for</span><span class="p">:</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">keywords</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;Aviation&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Airline&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Flights&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Airport&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Planes&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You will also need to determine in which markets you want to fetch the news, since we want a very international perspective and get the aviation news from every country we ask for every news country. So we need a list of markets to search in.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_codes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;da-DK&#39;</span><span class="p">,</span>
                <span class="s1">&#39;de-AT&#39;</span><span class="p">,</span>
                <span class="s1">&#39;de-CH&#39;</span><span class="p">,</span>
                <span class="s1">&#39;de-DE&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-AU&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-CA&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-GB&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-ID&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-IE&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-IN&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-MY&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-NZ&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-PH&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-SG&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-US&#39;</span><span class="p">,</span>
                <span class="s1">&#39;en-ZA&#39;</span><span class="p">,</span>
                <span class="s1">&#39;es-AR&#39;</span><span class="p">,</span>
                <span class="s1">&#39;es-CL&#39;</span><span class="p">,</span>
                <span class="s1">&#39;es-ES&#39;</span><span class="p">,</span>
                <span class="s1">&#39;es-MX&#39;</span><span class="p">,</span>
                <span class="s1">&#39;fi-FI&#39;</span><span class="p">,</span>
                <span class="s1">&#39;fr-FR&#39;</span><span class="p">,</span>
                <span class="s1">&#39;it-IT&#39;</span><span class="p">,</span>
                <span class="s1">&#39;ja-JP&#39;</span><span class="p">,</span>
                <span class="s1">&#39;ko-KR&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nl-BE&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nl-NL&#39;</span><span class="p">,</span>
                <span class="s1">&#39;pl-PL&#39;</span><span class="p">,</span>
                <span class="s1">&#39;pt-BR&#39;</span><span class="p">,</span>
                <span class="s1">&#39;ru-RU&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sv-SE&#39;</span><span class="p">,</span>
                <span class="s1">&#39;tr-TR&#39;</span><span class="p">,</span>
                <span class="s1">&#39;zh-CN&#39;</span><span class="p">,</span>
                <span class="s1">&#39;zh-HK&#39;</span><span class="p">,</span>
                <span class="s1">&#39;zh-TW&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can copy and paste the table with all the markets, but you can also remember that pandas has a very neat table scraping function, so with a little pd.read_html and filters these afterwards.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">markets_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s1">&#39;https://docs.microsoft.com/en-us/rest/api/cognitiveservices-bingsearch/bing-news-api-v7-reference#market-codes&#39;</span><span class="p">)[</span><span class="mi">23</span><span class="p">]</span>
<span class="n">markets_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country/Region</th>
      <th>Language</th>
      <th>Market Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Denmark</td>
      <td>Danish</td>
      <td>da-DK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austria</td>
      <td>German</td>
      <td>de-AT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belgium</td>
      <td>Dutch</td>
      <td>nl-BE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Switzerland</td>
      <td>German</td>
      <td>de-CH</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Germany</td>
      <td>German</td>
      <td>de-DE</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Australia</td>
      <td>English</td>
      <td>en-AU</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Canada</td>
      <td>English</td>
      <td>en-CA</td>
    </tr>
    <tr>
      <th>7</th>
      <td>United Kingdom</td>
      <td>English</td>
      <td>en-GB</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Indonesia</td>
      <td>English</td>
      <td>en-ID</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Ireland</td>
      <td>English</td>
      <td>en-IE</td>
    </tr>
    <tr>
      <th>10</th>
      <td>India</td>
      <td>English</td>
      <td>en-IN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Malaysia</td>
      <td>English</td>
      <td>en-MY</td>
    </tr>
    <tr>
      <th>12</th>
      <td>New Zealand</td>
      <td>English</td>
      <td>en-NZ</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Republic of the Philippines</td>
      <td>English</td>
      <td>en-PH</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Singapore</td>
      <td>English</td>
      <td>en-SG</td>
    </tr>
    <tr>
      <th>15</th>
      <td>United States</td>
      <td>English</td>
      <td>en-US</td>
    </tr>
    <tr>
      <th>16</th>
      <td>English</td>
      <td>general</td>
      <td>en-WW</td>
    </tr>
    <tr>
      <th>17</th>
      <td>English</td>
      <td>general</td>
      <td>en-XA</td>
    </tr>
    <tr>
      <th>18</th>
      <td>South Africa</td>
      <td>English</td>
      <td>en-ZA</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Argentina</td>
      <td>Spanish</td>
      <td>es-AR</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Chile</td>
      <td>Spanish</td>
      <td>es-CL</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Spain</td>
      <td>Spanish</td>
      <td>es-ES</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Mexico</td>
      <td>Spanish</td>
      <td>es-MX</td>
    </tr>
    <tr>
      <th>23</th>
      <td>United States</td>
      <td>Spanish</td>
      <td>es-US</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Spanish</td>
      <td>general</td>
      <td>es-XL</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Finland</td>
      <td>Finnish</td>
      <td>fi-FI</td>
    </tr>
    <tr>
      <th>26</th>
      <td>France</td>
      <td>French</td>
      <td>fr-BE</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Canada</td>
      <td>French</td>
      <td>fr-CA</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Switzerland</td>
      <td>French</td>
      <td>fr-CH</td>
    </tr>
    <tr>
      <th>29</th>
      <td>France</td>
      <td>French</td>
      <td>fr-FR</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Italy</td>
      <td>Italian</td>
      <td>it-IT</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Hong Kong SAR</td>
      <td>Traditional Chinese</td>
      <td>zh-HK</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Taiwan</td>
      <td>Traditional Chinese</td>
      <td>zh-TW</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Japan</td>
      <td>Japanese</td>
      <td>ja-JP</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Korea</td>
      <td>Korean</td>
      <td>ko-KR</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Netherlands</td>
      <td>Dutch</td>
      <td>nl-NL</td>
    </tr>
    <tr>
      <th>36</th>
      <td>People's republic of China</td>
      <td>Chinese</td>
      <td>zh-CN</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Poland</td>
      <td>Polish</td>
      <td>pl-PL</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Brazil</td>
      <td>Portuguese</td>
      <td>pt-BR</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Russia</td>
      <td>Russian</td>
      <td>ru-RU</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Sweden</td>
      <td>Swedish</td>
      <td>sv-SE</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Turkey</td>
      <td>Turkish</td>
      <td>tr-TR</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_keywords_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;da-DK&#39;,
 &#39;de-AT&#39;,
 &#39;de-CH&#39;,
 &#39;de-DE&#39;,
 &#39;en-AU&#39;,
 &#39;en-CA&#39;,
 &#39;en-GB&#39;,
 &#39;en-ID&#39;,
 &#39;en-IE&#39;,
 &#39;en-IN&#39;,
 &#39;en-MY&#39;,
 &#39;en-NZ&#39;,
 &#39;en-PH&#39;,
 &#39;en-SG&#39;,
 &#39;en-US&#39;,
 &#39;en-ZA&#39;,
 &#39;es-AR&#39;,
 &#39;es-CL&#39;,
 &#39;es-ES&#39;,
 &#39;es-MX&#39;,
 &#39;fi-FI&#39;,
 &#39;fr-FR&#39;,
 &#39;it-IT&#39;,
 &#39;ja-JP&#39;,
 &#39;ko-KR&#39;,
 &#39;nl-BE&#39;,
 &#39;nl-NL&#39;,
 &#39;pl-PL&#39;,
 &#39;pt-BR&#39;,
 &#39;ru-RU&#39;,
 &#39;sv-SE&#39;,
 &#39;tr-TR&#39;,
 &#39;zh-CN&#39;,
 &#39;zh-HK&#39;,
 &#39;zh-TW&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pycountry</span>
<span class="kn">from</span> <span class="nn">google_trans_new</span> <span class="kn">import</span> <span class="n">google_translator</span>




<span class="k">def</span> <span class="nf">generate_market_keywords</span><span class="p">(</span><span class="n">keywords</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span><span class="n">market_codes</span><span class="p">:</span><span class="nb">list</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  keywords : list</span>
<span class="sd">    list of keywords to be translated in the target language (as provided in the market-codes)</span>
<span class="sd">  market_codes : list</span>
<span class="sd">    list of market_codes, formatted as language_iso_alpha_2-COUNTRY_ISO_ALPHA_2 , e.g &#39;da-DK&#39;</span>

<span class="sd">  Returns</span>
<span class="sd">  -------</span>
<span class="sd">  market_codes_country_language_alpha3_keywords : dict</span>
<span class="sd">  {</span>
<span class="sd">    &#39;da-DK&#39;: {</span>
<span class="sd">      &#39;Country/Region&#39;: &#39;Denmark&#39;,</span>
<span class="sd">      &#39;Language&#39;: &#39;Danish&#39;,</span>
<span class="sd">      &#39;iso_alpha&#39;: &#39;DNK&#39;,</span>
<span class="sd">      &#39;keywords&#39;: &#39;Luftfart Flyselskab Fly Lufthavn Planer&#39;,</span>
<span class="sd">      &#39;language_iso_alpha_2&#39;: &#39;da&#39;</span>
<span class="sd">      },</span>
<span class="sd"> &#39;de-AT&#39;: {</span>
<span class="sd">   &#39;Country/Region&#39;: &#39;Austria&#39;,</span>
<span class="sd">   &#39;Language&#39;: &#39;German&#39;,</span>
<span class="sd">   &#39;iso_alpha&#39;: &#39;AUT&#39;,</span>
<span class="sd">   &#39;keywords&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,</span>
<span class="sd">   &#39;language_iso_alpha_2&#39;: &#39;de&#39;</span>
<span class="sd">   }</span>
<span class="sd">  }</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">translate_keywords</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">keywords</span><span class="p">,</span> <span class="n">language_iso_alpha_2</span><span class="p">:</span> <span class="p">[</span>
                                                <span class="n">google_translator</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span>
                                                    <span class="n">keyword</span><span class="p">,</span> 
                                                    <span class="n">lang_tgt</span><span class="o">=</span><span class="n">language_iso_alpha_2</span><span class="p">,</span>
                                                    <span class="n">lang_src</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span>
                                                    <span class="p">)</span> 
                                                <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">keywords</span>
                                                <span class="p">]</span>
  <span class="c1"># generate the set of languages in the target markets</span>
  <span class="n">target_languages</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">get_country_language_iso_alpha</span><span class="p">(</span><span class="n">market_code</span><span class="p">)[</span><span class="s1">&#39;language_iso_alpha_2&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">market_code</span> <span class="ow">in</span> <span class="n">market_codes</span><span class="p">])</span>
  <span class="c1"># generate the dictionary with language as the key and translates keywords as values</span>
  <span class="n">keywords_translated</span> <span class="o">=</span> <span class="p">{</span><span class="n">language</span> <span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">translate_keywords</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">language</span><span class="p">))</span> <span class="k">for</span> <span class="n">language</span> <span class="ow">in</span> <span class="n">target_languages</span><span class="p">}</span>

  <span class="k">return</span> <span class="p">{</span><span class="n">market_code</span><span class="p">:{</span><span class="o">**</span><span class="n">get_country_language_iso_alpha</span><span class="p">(</span><span class="n">market_code</span><span class="p">),</span>
                <span class="o">**</span><span class="p">{</span><span class="s2">&quot;keywords&quot;</span><span class="p">:</span><span class="n">keywords_translated</span><span class="p">[</span><span class="n">get_country_language_iso_alpha</span><span class="p">(</span><span class="n">market_code</span><span class="p">)[</span><span class="s1">&#39;language_iso_alpha_2&#39;</span><span class="p">]]}</span>
  <span class="p">}</span> <span class="k">for</span> <span class="n">market_code</span> <span class="ow">in</span> <span class="n">market_codes</span><span class="p">}</span>

<span class="n">generate_market_keywords</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span><span class="n">market_codes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.7/dist-packages/pkg_resources/_vendor/pyparsing.py:3552: RuntimeWarning: coroutine &#39;async_series_translator&#39; was never awaited
  ret = e._parse( instring, loc, doActions )
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-53-f5dab7e639fe&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>   } for market_code in market_codes}
<span class="ansi-green-intense-fg ansi-bold">     91</span> 
<span class="ansi-green-fg">---&gt; 92</span><span class="ansi-red-fg"> </span>generate_market_keywords<span class="ansi-blue-fg">(</span>keywords<span class="ansi-blue-fg">,</span>market_codes<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-53-f5dab7e639fe&gt;</span> in <span class="ansi-cyan-fg">generate_market_keywords</span><span class="ansi-blue-fg">(keywords, market_codes)</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>                                                 ]
<span class="ansi-green-intense-fg ansi-bold">     83</span>   <span class="ansi-red-fg"># generate the set of languages in the target markets</span>
<span class="ansi-green-fg">---&gt; 84</span><span class="ansi-red-fg">   </span>target_languages <span class="ansi-blue-fg">=</span> set<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>get_country_language_iso_alpha<span class="ansi-blue-fg">(</span>market_code<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;language_iso_alpha_2&#39;</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> market_code <span class="ansi-green-fg">in</span> market_codes<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span>   <span class="ansi-red-fg"># generate the dictionary with language as the key and translates keywords as values</span>
<span class="ansi-green-intense-fg ansi-bold">     86</span>   keywords_translated <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span>language <span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">&#34; &#34;</span><span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>translate_keywords<span class="ansi-blue-fg">(</span>keywords<span class="ansi-blue-fg">,</span>language<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> language <span class="ansi-green-fg">in</span> target_languages<span class="ansi-blue-fg">}</span>

<span class="ansi-green-fg">&lt;ipython-input-53-f5dab7e639fe&gt;</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span>                                                 ]
<span class="ansi-green-intense-fg ansi-bold">     83</span>   <span class="ansi-red-fg"># generate the set of languages in the target markets</span>
<span class="ansi-green-fg">---&gt; 84</span><span class="ansi-red-fg">   </span>target_languages <span class="ansi-blue-fg">=</span> set<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>get_country_language_iso_alpha<span class="ansi-blue-fg">(</span>market_code<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;language_iso_alpha_2&#39;</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> market_code <span class="ansi-green-fg">in</span> market_codes<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     85</span>   <span class="ansi-red-fg"># generate the dictionary with language as the key and translates keywords as values</span>
<span class="ansi-green-intense-fg ansi-bold">     86</span>   keywords_translated <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span>language <span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">&#34; &#34;</span><span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>translate_keywords<span class="ansi-blue-fg">(</span>keywords<span class="ansi-blue-fg">,</span>language<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> language <span class="ansi-green-fg">in</span> target_languages<span class="ansi-blue-fg">}</span>

<span class="ansi-red-fg">NameError</span>: name &#39;get_country_language_iso_alpha&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">markets_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;da-DK&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Denmark&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Danish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;DNK&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luftfart Flyselskab Fly Lufthavn Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;de-AT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Austria&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;German&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;AUT&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;</span><span class="p">},</span>
 <span class="s1">&#39;de-CH&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Switzerland&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;German&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;CHE&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;</span><span class="p">},</span>
 <span class="s1">&#39;de-DE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;German&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;DEU&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-AU&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Australia&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;AUS&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-CA&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Canada&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;CAN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-GB&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;GBR&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-ID&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Indonesia&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;IDN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-IE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;IRL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-IN&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;India&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;IND&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-MY&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Malaysia&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;MYS&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-NZ&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;New Zealand&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;NZL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-PH&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Republic of the Philippines&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;PHL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-SG&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Singapore&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;SGP&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-US&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;United States&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;en-ZA&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;South Africa&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;English&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;ZAF&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Airline Flights Airport Plane&#39;</span><span class="p">},</span>
 <span class="s1">&#39;es-AR&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;</span><span class="p">},</span>
 <span class="s1">&#39;es-CL&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Chile&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;CHL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;</span><span class="p">},</span>
 <span class="s1">&#39;es-ES&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Spain&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;ESP&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;</span><span class="p">},</span>
 <span class="s1">&#39;es-MX&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Mexico&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Spanish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;MEX&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;</span><span class="p">},</span>
 <span class="s1">&#39;fi-FI&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Finland&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Finnish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;FIN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;ilmailu lentoyhtiö lennot Lentokenttä kone&#39;</span><span class="p">},</span>
 <span class="s1">&#39;fr-FR&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;France&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;French&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;FRA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviation Compagnie aérienne Vols Aéroport Avion&#39;</span><span class="p">},</span>
 <span class="s1">&#39;it-IT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Italy&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Italian&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;ITA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;aviazione linea aerea voli Aeroporto Aereo&#39;</span><span class="p">},</span>
 <span class="s1">&#39;ja-JP&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Japan&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Japanese&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;JPN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;航空 エアライン フライト 空港 飛行機&#39;</span><span class="p">},</span>
 <span class="s1">&#39;ko-KR&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Korea&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Korean&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;KOR&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;비행 공기 호스 항공편 공항 비행기&#39;</span><span class="p">},</span>
 <span class="s1">&#39;nl-BE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Dutch&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;BEL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;</span><span class="p">},</span>
 <span class="s1">&#39;nl-NL&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Netherlands&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Dutch&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;NLD&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;</span><span class="p">},</span>
 <span class="s1">&#39;pl-PL&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Poland&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Polish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;POL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Lotnictwo Linia lotnicza Loty Lotnisko Samolot&#39;</span><span class="p">},</span>
 <span class="s1">&#39;pt-BR&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Brazil&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Portuguese&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;BRA&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Aviação CIA aérea Voos Aeroporto Avião&#39;</span><span class="p">},</span>
 <span class="s1">&#39;ru-RU&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Russia&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Russian&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;RUS&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;авиации авиакомпания рейсы аэропорт Плане&#39;</span><span class="p">},</span>
 <span class="s1">&#39;sv-SE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Sweden&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Swedish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;SWE&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Flyg Flygbolag Flyg Flygplats Plan&#39;</span><span class="p">},</span>
 <span class="s1">&#39;tr-TR&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Turkey&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Turkish&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;TUR&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Havacılık Havayolu Uçak Havalimanı uçak&#39;</span><span class="p">},</span>
 <span class="s1">&#39;zh-CN&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s2">&quot;People&#39;s republic of China&quot;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Chinese (simplified)&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;CHN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;航空 航空公司 机票 飞机场 平面&#39;</span><span class="p">},</span>
 <span class="s1">&#39;zh-HK&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Hong Kong SAR&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Chinese (traditional)&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;HKG&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;航空 航空公司 機票 飛機場 平面&#39;</span><span class="p">},</span>
 <span class="s1">&#39;zh-TW&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">:</span> <span class="s1">&#39;Taiwan&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Language&#39;</span><span class="p">:</span> <span class="s1">&#39;Chinese (traditional)&#39;</span><span class="p">,</span>
  <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="s1">&#39;TWN&#39;</span><span class="p">,</span>
  <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;航空 航空公司 機票 飛機場 平面&#39;</span><span class="p">}}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pycountry</span>
<span class="k">def</span> <span class="nf">get_country_language_iso_alpha</span><span class="p">(</span><span class="n">market_code</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  </span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="n">language_iso_alpha_2</span><span class="p">,</span><span class="n">country_alpha_2</span> <span class="o">=</span> <span class="n">market_code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

  <span class="k">return</span> <span class="p">{</span>
      <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alpha_2</span><span class="o">=</span><span class="n">country_alpha_2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">languages</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alpha_2</span><span class="o">=</span><span class="n">language_iso_alpha_2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="s1">&#39;language_iso_alpha_2&#39;</span><span class="p">:</span><span class="n">language_iso_alpha_2</span><span class="p">,</span>
      <span class="s1">&#39;iso_alpha&#39;</span><span class="p">:</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alpha_2</span><span class="o">=</span><span class="n">country_alpha_2</span><span class="p">)</span><span class="o">.</span><span class="n">alpha_3</span>
      
  <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pycountry</span> <span class="n">google_trans_new</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting pycountry
  Downloading https://files.pythonhosted.org/packages/76/73/6f1a412f14f68c273feea29a6ea9b9f1e268177d32e0e69ad6790d306312/pycountry-20.7.3.tar.gz (10.1MB)
     |████████████████████████████████| 10.1MB 2.1MB/s 
Collecting google_trans_new
  Downloading https://files.pythonhosted.org/packages/f9/7b/9f136106dc5824dc98185c97991d3cd9b53e70a197154dd49f7b899128f6/google_trans_new-1.1.9-py3-none-any.whl
Building wheels for collected packages: pycountry
  Building wheel for pycountry (setup.py) ... done
  Created wheel for pycountry: filename=pycountry-20.7.3-py2.py3-none-any.whl size=10746863 sha256=bfce3fcbaaee04549c259d91a5ff4713f638ef0e3c52b322f2a4b49c249d7cf1
  Stored in directory: /root/.cache/pip/wheels/33/4e/a6/be297e6b83567e537bed9df4a93f8590ec01c1acfbcd405348
Successfully built pycountry
Installing collected packages: pycountry, google-trans-new
Successfully installed google-trans-new-1.1.9 pycountry-20.7.3
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_keywords_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country/Region</th>
      <th>Language</th>
      <th>iso_alpha</th>
      <th>keywords</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>da-DK</th>
      <td>Denmark</td>
      <td>Danish</td>
      <td>DNK</td>
      <td>Luftfart Flyselskab Fly Lufthavn Plane</td>
    </tr>
    <tr>
      <th>de-AT</th>
      <td>Austria</td>
      <td>German</td>
      <td>AUT</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>de-CH</th>
      <td>Switzerland</td>
      <td>German</td>
      <td>CHE</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>de-DE</th>
      <td>Germany</td>
      <td>German</td>
      <td>DEU</td>
      <td>Luftfahrt Fluggesellschaft Flüge Flughafen Flu...</td>
    </tr>
    <tr>
      <th>en-AU</th>
      <td>Australia</td>
      <td>English</td>
      <td>AUS</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-CA</th>
      <td>Canada</td>
      <td>English</td>
      <td>CAN</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-GB</th>
      <td>United Kingdom</td>
      <td>English</td>
      <td>GBR</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-ID</th>
      <td>Indonesia</td>
      <td>English</td>
      <td>IDN</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-IE</th>
      <td>Ireland</td>
      <td>English</td>
      <td>IRL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-IN</th>
      <td>India</td>
      <td>English</td>
      <td>IND</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-MY</th>
      <td>Malaysia</td>
      <td>English</td>
      <td>MYS</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-NZ</th>
      <td>New Zealand</td>
      <td>English</td>
      <td>NZL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-PH</th>
      <td>Republic of the Philippines</td>
      <td>English</td>
      <td>PHL</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-SG</th>
      <td>Singapore</td>
      <td>English</td>
      <td>SGP</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-US</th>
      <td>United States</td>
      <td>English</td>
      <td>USA</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>en-ZA</th>
      <td>South Africa</td>
      <td>English</td>
      <td>ZAF</td>
      <td>Aviation Airline Flights Airport Plane</td>
    </tr>
    <tr>
      <th>es-AR</th>
      <td>Argentina</td>
      <td>Spanish</td>
      <td>ARG</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-CL</th>
      <td>Chile</td>
      <td>Spanish</td>
      <td>CHL</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-ES</th>
      <td>Spain</td>
      <td>Spanish</td>
      <td>ESP</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>es-MX</th>
      <td>Mexico</td>
      <td>Spanish</td>
      <td>MEX</td>
      <td>Aviación Aerolínea Vuelos Aeropuerto Avión</td>
    </tr>
    <tr>
      <th>fi-FI</th>
      <td>Finland</td>
      <td>Finnish</td>
      <td>FIN</td>
      <td>ilmailu lentoyhtiö lennot Lentokenttä kone</td>
    </tr>
    <tr>
      <th>fr-FR</th>
      <td>France</td>
      <td>French</td>
      <td>FRA</td>
      <td>Aviation Compagnie aérienne Vols Aéroport Avion</td>
    </tr>
    <tr>
      <th>it-IT</th>
      <td>Italy</td>
      <td>Italian</td>
      <td>ITA</td>
      <td>aviazione linea aerea voli Aeroporto Aereo</td>
    </tr>
    <tr>
      <th>ja-JP</th>
      <td>Japan</td>
      <td>Japanese</td>
      <td>JPN</td>
      <td>航空 エアライン フライト 空港 飛行機</td>
    </tr>
    <tr>
      <th>ko-KR</th>
      <td>Korea</td>
      <td>Korean</td>
      <td>KOR</td>
      <td>비행 공기 호스 항공편 공항 비행기</td>
    </tr>
    <tr>
      <th>nl-BE</th>
      <td>Belgium</td>
      <td>Dutch</td>
      <td>BEL</td>
      <td>Luchtvaart vliegmaatschappij Vluchten Luchthav...</td>
    </tr>
    <tr>
      <th>nl-NL</th>
      <td>Netherlands</td>
      <td>Dutch</td>
      <td>NLD</td>
      <td>Luchtvaart vliegmaatschappij Vluchten Luchthav...</td>
    </tr>
    <tr>
      <th>pl-PL</th>
      <td>Poland</td>
      <td>Polish</td>
      <td>POL</td>
      <td>Lotnictwo Linia lotnicza Loty Lotnisko Samolot</td>
    </tr>
    <tr>
      <th>pt-BR</th>
      <td>Brazil</td>
      <td>Portuguese</td>
      <td>BRA</td>
      <td>Aviação CIA aérea Voos Aeroporto Avião</td>
    </tr>
    <tr>
      <th>ru-RU</th>
      <td>Russia</td>
      <td>Russian</td>
      <td>RUS</td>
      <td>авиации авиакомпания рейсы аэропорт Плане</td>
    </tr>
    <tr>
      <th>sv-SE</th>
      <td>Sweden</td>
      <td>Swedish</td>
      <td>SWE</td>
      <td>Flyg Flygbolag Flyg Flygplats Plan</td>
    </tr>
    <tr>
      <th>tr-TR</th>
      <td>Turkey</td>
      <td>Turkish</td>
      <td>TUR</td>
      <td>Havacılık Havayolu Uçak Havalimanı uçak</td>
    </tr>
    <tr>
      <th>zh-CN</th>
      <td>People's republic of China</td>
      <td>Chinese (simplified)</td>
      <td>CHN</td>
      <td>航空 航空公司 机票 飞机场 平面</td>
    </tr>
    <tr>
      <th>zh-HK</th>
      <td>Hong Kong SAR</td>
      <td>Chinese (traditional)</td>
      <td>HKG</td>
      <td>航空 航空公司 機票 飛機場 平面</td>
    </tr>
    <tr>
      <th>zh-TW</th>
      <td>Taiwan</td>
      <td>Chinese (traditional)</td>
      <td>TWN</td>
      <td>航空 航空公司 機票 飛機場 平面</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_keywords_dict</span> <span class="o">=</span> <span class="n">market_keywords_df</span><span class="p">[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">market_keywords_dict</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;da-DK&#39;: &#39;Luftfart Flyselskab Fly Lufthavn Plane&#39;,
 &#39;de-AT&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;de-CH&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;de-DE&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;en-AU&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-CA&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-GB&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-ID&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-IE&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-IN&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-MY&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-NZ&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-PH&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-SG&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-US&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-ZA&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;es-AR&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-CL&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-ES&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-MX&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;fi-FI&#39;: &#39;ilmailu lentoyhtiö lennot Lentokenttä kone&#39;,
 &#39;fr-FR&#39;: &#39;Aviation Compagnie aérienne Vols Aéroport Avion&#39;,
 &#39;it-IT&#39;: &#39;aviazione linea aerea voli Aeroporto Aereo&#39;,
 &#39;ja-JP&#39;: &#39;航空 エアライン フライト 空港 飛行機&#39;,
 &#39;ko-KR&#39;: &#39;비행 공기 호스 항공편 공항 비행기&#39;,
 &#39;nl-BE&#39;: &#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;,
 &#39;nl-NL&#39;: &#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;,
 &#39;pl-PL&#39;: &#39;Lotnictwo Linia lotnicza Loty Lotnisko Samolot&#39;,
 &#39;pt-BR&#39;: &#39;Aviação CIA aérea Voos Aeroporto Avião&#39;,
 &#39;ru-RU&#39;: &#39;авиации авиакомпания рейсы аэропорт Плане&#39;,
 &#39;sv-SE&#39;: &#39;Flyg Flygbolag Flyg Flygplats Plan&#39;,
 &#39;tr-TR&#39;: &#39;Havacılık Havayolu Uçak Havalimanı uçak&#39;,
 &#39;zh-CN&#39;: &#39;航空 航空公司 机票 飞机场 平面&#39;,
 &#39;zh-HK&#39;: &#39;航空 航空公司 機票 飛機場 平面&#39;,
 &#39;zh-TW&#39;: &#39;航空 航空公司 機票 飛機場 平面&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">backoff</span> <span class="n">aiohttp</span> <span class="n">asyncio</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting backoff
  Downloading https://files.pythonhosted.org/packages/f0/32/c5dd4f4b0746e9ec05ace2a5045c1fc375ae67ee94355344ad6c7005fd87/backoff-1.10.0-py2.py3-none-any.whl
Collecting aiohttp
  Downloading https://files.pythonhosted.org/packages/88/c0/5890b4c8b04a79b7360e8fe4490feb0bb3ab179743f199f0e6220cebd568/aiohttp-3.7.4.post0-cp37-cp37m-manylinux2014_x86_64.whl (1.3MB)
     |████████████████████████████████| 1.3MB 13.7MB/s 
Collecting asyncio
  Downloading https://files.pythonhosted.org/packages/22/74/07679c5b9f98a7cb0fc147b1ef1cc1853bc07a4eb9cb5731e24732c5f773/asyncio-3.4.3-py3-none-any.whl (101kB)
     |████████████████████████████████| 102kB 11.9MB/s 
Requirement already satisfied: typing-extensions&gt;=3.6.5 in /usr/local/lib/python3.7/dist-packages (from aiohttp) (3.7.4.3)
Requirement already satisfied: chardet&lt;5.0,&gt;=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp) (3.0.4)
Collecting multidict&lt;7.0,&gt;=4.5
  Downloading https://files.pythonhosted.org/packages/7c/a6/4123b8165acbe773d1a8dc8e3f0d1edea16d29f7de018eda769abb56bd30/multidict-5.1.0-cp37-cp37m-manylinux2014_x86_64.whl (142kB)
     |████████████████████████████████| 143kB 36.3MB/s 
Collecting async-timeout&lt;4.0,&gt;=3.0
  Downloading https://files.pythonhosted.org/packages/e1/1e/5a4441be21b0726c4464f3f23c8b19628372f606755a9d2e46c187e65ec4/async_timeout-3.0.1-py3-none-any.whl
Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp) (21.2.0)
Collecting yarl&lt;2.0,&gt;=1.0
  Downloading https://files.pythonhosted.org/packages/f1/62/046834c5fc998c88ab2ef722f5d42122230a632212c8afa76418324f53ff/yarl-1.6.3-cp37-cp37m-manylinux2014_x86_64.whl (294kB)
     |████████████████████████████████| 296kB 38.7MB/s 
Requirement already satisfied: idna&gt;=2.0 in /usr/local/lib/python3.7/dist-packages (from yarl&lt;2.0,&gt;=1.0-&gt;aiohttp) (2.10)
Installing collected packages: backoff, multidict, async-timeout, yarl, aiohttp, asyncio
Successfully installed aiohttp-3.7.4.post0 async-timeout-3.0.1 asyncio-3.4.3 backoff-1.10.0 multidict-5.1.0 yarl-1.6.3
</pre>
</div>
</div>

<div class="output_area">




</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">market_keywords_dict</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;da-DK&#39;: &#39;Luftfart Flyselskab Fly Lufthavn Plane&#39;,
 &#39;de-AT&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;de-CH&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;de-DE&#39;: &#39;Luftfahrt Fluggesellschaft Flüge Flughafen Flugzeug&#39;,
 &#39;en-AU&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-CA&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-GB&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-ID&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-IE&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-IN&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-MY&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-NZ&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-PH&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-SG&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-US&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;en-ZA&#39;: &#39;Aviation Airline Flights Airport Plane&#39;,
 &#39;es-AR&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-CL&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-ES&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;es-MX&#39;: &#39;Aviación Aerolínea Vuelos Aeropuerto Avión&#39;,
 &#39;fi-FI&#39;: &#39;ilmailu lentoyhtiö lennot Lentokenttä kone&#39;,
 &#39;fr-FR&#39;: &#39;Aviation Compagnie aérienne Vols Aéroport Avion&#39;,
 &#39;it-IT&#39;: &#39;aviazione linea aerea voli Aeroporto Aereo&#39;,
 &#39;ja-JP&#39;: &#39;航空 エアライン フライト 空港 飛行機&#39;,
 &#39;ko-KR&#39;: &#39;비행 공기 호스 항공편 공항 비행기&#39;,
 &#39;nl-BE&#39;: &#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;,
 &#39;nl-NL&#39;: &#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;,
 &#39;pl-PL&#39;: &#39;Lotnictwo Linia lotnicza Loty Lotnisko Samolot&#39;,
 &#39;pt-BR&#39;: &#39;Aviação CIA aérea Voos Aeroporto Avião&#39;,
 &#39;ru-RU&#39;: &#39;авиации авиакомпания рейсы аэропорт Плане&#39;,
 &#39;sv-SE&#39;: &#39;Flyg Flygbolag Flyg Flygplats Plan&#39;,
 &#39;tr-TR&#39;: &#39;Havacılık Havayolu Uçak Havalimanı uçak&#39;,
 &#39;zh-CN&#39;: &#39;航空 航空公司 机票 飞机场 平面&#39;,
 &#39;zh-HK&#39;: &#39;航空 航空公司 機票 飛機場 平面&#39;,
 &#39;zh-TW&#39;: &#39;航空 航空公司 機票 飛機場 平面&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">markets_df</span><span class="p">[</span><span class="s1">&#39;Country/Region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Denmark&#39;, &#39;Austria&#39;, &#39;Belgium&#39;, &#39;Switzerland&#39;, &#39;Germany&#39;,
       &#39;Australia&#39;, &#39;Canada&#39;, &#39;United Kingdom&#39;, &#39;Indonesia&#39;, &#39;Ireland&#39;,
       &#39;India&#39;, &#39;Malaysia&#39;, &#39;New Zealand&#39;, &#39;Republic of the Philippines&#39;,
       &#39;Singapore&#39;, &#39;United States&#39;, &#39;English&#39;, &#39;South Africa&#39;,
       &#39;Argentina&#39;, &#39;Chile&#39;, &#39;Spain&#39;, &#39;Mexico&#39;, &#39;Spanish&#39;, &#39;Finland&#39;,
       &#39;France&#39;, &#39;Italy&#39;, &#39;Hong Kong SAR&#39;, &#39;Taiwan&#39;, &#39;Japan&#39;, &#39;Korea&#39;,
       &#39;Netherlands&#39;, &#34;People&#39;s republic of China&#34;, &#39;Poland&#39;, &#39;Brazil&#39;,
       &#39;Russia&#39;, &#39;Sweden&#39;, &#39;Turkey&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">markets_df</span><span class="p">[</span><span class="s1">&#39;Market Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;DK&#39;, &#39;AT&#39;, &#39;BE&#39;, &#39;CH&#39;, &#39;DE&#39;, &#39;AU&#39;, &#39;CA&#39;, &#39;GB&#39;, &#39;ID&#39;, &#39;IE&#39;, &#39;IN&#39;,
       &#39;MY&#39;, &#39;NZ&#39;, &#39;PH&#39;, &#39;SG&#39;, &#39;US&#39;, &#39;WW&#39;, &#39;XA&#39;, &#39;ZA&#39;, &#39;AR&#39;, &#39;CL&#39;, &#39;ES&#39;,
       &#39;MX&#39;, &#39;XL&#39;, &#39;FI&#39;, &#39;FR&#39;, &#39;IT&#39;, &#39;HK&#39;, &#39;TW&#39;, &#39;JP&#39;, &#39;KR&#39;, &#39;NL&#39;, &#39;CN&#39;,
       &#39;PL&#39;, &#39;BR&#39;, &#39;RU&#39;, &#39;SE&#39;, &#39;TR&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">unsync</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting unsync
  Downloading https://files.pythonhosted.org/packages/74/f8/80e4d6a6e9f36d7dc09e10522d98277c4576924f9f450100d57c8a80c269/unsync-1.3.2.tar.gz
Building wheels for collected packages: unsync
  Building wheel for unsync (setup.py) ... done
  Created wheel for unsync: filename=unsync-1.3.2-cp37-none-any.whl size=4967 sha256=37cd8ff7214893ecf5d40b7506f02ce149595f8513079064ced64888db744bf6
  Stored in directory: /root/.cache/pip/wheels/b2/31/43/4e734c578ffe46c8af109521ed8db656fcec4e6585bbdaf2a6
Successfully built unsync
Installing collected packages: unsync
Successfully installed unsync-1.3.2
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">unsync</span> <span class="kn">import</span> <span class="n">unsync</span>
<span class="kn">from</span> <span class="nn">google_trans_new</span> <span class="kn">import</span> <span class="n">google_translator</span>

<span class="nd">@unsync</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">async_series_translator</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="n">input_language_iso_alpha_2</span><span class="p">):</span> 
  <span class="k">return</span> <span class="n">google_translator</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span>
      <span class="n">sentence</span><span class="p">,</span> 
      <span class="n">lang_tgt</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
      <span class="n">lang_src</span> <span class="o">=</span> <span class="n">input_language_iso_alpha_2</span>
      <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%%</span><span class="n">timeit</span>
<span class="c1"># def translate_news_df_to_english(news_df:pd.DataFrame)-&gt;pd.DataFrame:</span>

<span class="n">input_language_iso_alpha_2</span> <span class="o">=</span> <span class="n">news_df</span><span class="p">[</span><span class="s1">&#39;market&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">news_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;description&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sentence</span><span class="p">:</span> <span class="p">(</span><span class="n">async_series_translator</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span><span class="n">input_language_iso_alpha_2</span><span class="p">))</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>

<span class="c1"># return news_df</span>
<span class="c1"># translate_news_df_to_english(news_df)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 loop, best of 5: 1.28 s per loop
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">input_language_iso_alpha_2</span> <span class="o">=</span> <span class="n">news_df</span><span class="p">[</span><span class="s1">&#39;market&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">news_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;description&#39;</span><span class="p">]]</span> <span class="o">=</span>  <span class="n">news_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;description&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">sentence</span><span class="p">:</span> <span class="n">google_translator</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span>
      <span class="n">sentence</span><span class="p">,</span> 
      <span class="n">lang_tgt</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
      <span class="n">lang_src</span> <span class="o">=</span> <span class="s1">&#39;nl&#39;</span>
      <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">create_news_df</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">backoff</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">aiohttp</span>
<span class="kn">import</span> <span class="nn">asyncio</span>

<span class="n">mkt</span> <span class="o">=</span> <span class="s1">&#39;nl-NL&#39;</span>
<span class="n">keywords</span> <span class="o">=</span> <span class="s1">&#39;Luchtvaart vliegmaatschappij Vluchten Luchthaven Vliegtuig&#39;</span>

<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;backoff&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">())</span>

<span class="n">search_url</span> <span class="o">=</span> <span class="s2">&quot;https://api.cognitive.microsoft.com/bing/v7.0/news/search&quot;</span>
<span class="n">freshness</span> <span class="o">=</span> <span class="s1">&#39;Week&#39;</span>
<span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;Business&#39;</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ocp-Apim-Subscription-Key&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;BING_NEWS_API_KEY&#39;</span><span class="p">)}</span>

<span class="nd">@unsync</span>
<span class="nd">@backoff</span><span class="o">.</span><span class="n">on_exception</span><span class="p">(</span><span class="n">backoff</span><span class="o">.</span><span class="n">expo</span><span class="p">,</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientError</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_bing_news</span><span class="p">(</span><span class="n">market_code</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="n">keywords</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
  <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">,</span>
    <span class="s1">&#39;freshness&#39;</span><span class="p">:</span> <span class="n">freshness</span><span class="p">,</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;mkt&#39;</span><span class="p">:</span> <span class="n">mkt</span><span class="p">,</span>
    <span class="c1"># &#39;category&#39;:category,</span>
    <span class="c1"># &quot;textDecorations&quot;: True, &quot;textFormat&quot;: &quot;RAW&quot;</span>
<span class="p">}</span>
  <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
      <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
          <span class="k">return</span> <span class="k">await</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;value&#39;</span><span class="p">])[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;datePublished&#39;</span><span class="p">]]</span>


<span class="n">get_bing_news</span><span class="p">(</span><span class="n">mkt</span><span class="p">,</span><span class="n">keywords</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

<span class="c1"># def bing_aviation_news(market_keywords:dict):</span>
  
<span class="c1">#         search_url = &quot;https://api.cognitive.microsoft.com/bing/v7.0/news/search&quot;</span>
<span class="c1">#         freshness = &#39;Week&#39;</span>
<span class="c1">#         category = &#39;Business&#39;</span>
<span class="c1">#         headers = {&quot;Ocp-Apim-Subscription-Key&quot;: os.getenv(&#39;BING_NEWS_API_KEY&#39;)}</span>
<span class="c1">#         params = {</span>
<span class="c1">#             &quot;q&quot;: keywords,</span>
<span class="c1">#             &#39;freshness&#39;: freshness,</span>
<span class="c1">#             &#39;count&#39;: 10,</span>
<span class="c1">#             &#39;mkt&#39;: mkt,</span>
<span class="c1">#             # &#39;category&#39;:category,</span>
<span class="c1">#             # &quot;textDecorations&quot;: True, &quot;textFormat&quot;: &quot;RAW&quot;</span>
<span class="c1">#         }</span>


<span class="c1">#     translator = google_translator()</span>

<span class="c1">#     def bing_news_country(keywords, mkt,iso_alpha):</span>
<span class="c1">#         try:</span>
<span class="c1">#             resp = req.get(search_url, headers=headers, params=params)</span>
<span class="c1">#             resp.raise_for_status()</span>
<span class="c1">#             df = pd.DataFrame.from_dict(resp.json()[&#39;value&#39;])[[&#39;name&#39;, &#39;url&#39;, &#39;datePublished&#39;]]</span>
<span class="c1">#             if mkt.split(&#39;-&#39;)[0] != &#39;en&#39;:</span>
<span class="c1">#                 try:</span>

<span class="c1">#                     df[&#39;name&#39;] = [translator.translate(title, lang_tgt=&#39;en&#39;) for title in df[&#39;name&#39;]]</span>

<span class="c1">#                 except Exception as e:</span>
<span class="c1">#                     print(e)</span>


<span class="c1">#         except:</span>
<span class="c1">#             df = pd.DataFrame([[&#39;no_news_found&#39;, None, None]], columns=[&#39;name&#39;,&#39;url&#39;,&#39;datePublished&#39;])</span>

<span class="c1">#         df[&#39;date&#39;] = today.date().strftime(dt_format)</span>
<span class="c1">#         df[&#39;iso_alpha&#39;] = iso_alpha</span>
<span class="c1">#         return df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-72-a3e56173edd1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span> 
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-fg">---&gt; 34</span><span class="ansi-red-fg"> </span>get_bing_news<span class="ansi-blue-fg">(</span>mkt<span class="ansi-blue-fg">,</span>keywords<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span> 
<span class="ansi-green-intense-fg ansi-bold">     36</span> <span class="ansi-red-fg"># def bing_aviation_news(market_keywords:dict):</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/unsync/unsync.py</span> in <span class="ansi-cyan-fg">result</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    142</span>             <span class="ansi-green-fg">raise</span> asyncio<span class="ansi-blue-fg">.</span>InvalidStateError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Calling result() in an unsync method is not allowed&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span>         <span class="ansi-red-fg"># Wait on the concurrent Future outside unsync.thread</span>
<span class="ansi-green-fg">--&gt; 144</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>concurrent_future<span class="ansi-blue-fg">.</span>result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span> 
<span class="ansi-green-intense-fg ansi-bold">    146</span>     <span class="ansi-green-fg">def</span> done<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/lib/python3.7/concurrent/futures/_base.py</span> in <span class="ansi-cyan-fg">result</span><span class="ansi-blue-fg">(self, timeout)</span>
<span class="ansi-green-intense-fg ansi-bold">    433</span>                 <span class="ansi-green-fg">raise</span> CancelledError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    434</span>             <span class="ansi-green-fg">elif</span> self<span class="ansi-blue-fg">.</span>_state <span class="ansi-blue-fg">==</span> FINISHED<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 435</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>__get_result<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    436</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    437</span>                 <span class="ansi-green-fg">raise</span> TimeoutError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/lib/python3.7/concurrent/futures/_base.py</span> in <span class="ansi-cyan-fg">__get_result</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    382</span>     <span class="ansi-green-fg">def</span> __get_result<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    383</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 384</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> self<span class="ansi-blue-fg">.</span>_exception
<span class="ansi-green-intense-fg ansi-bold">    385</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    386</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_result

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/backoff/_async.py</span> in <span class="ansi-cyan-fg">retry</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    131</span> 
<span class="ansi-green-intense-fg ansi-bold">    132</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 133</span><span class="ansi-red-fg">                 </span>ret <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> target<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    134</span>             <span class="ansi-green-fg">except</span> exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    135</span>                 giveup_result <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> giveup<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-72-a3e56173edd1&gt;</span> in <span class="ansi-cyan-fg">get_bing_news</span><span class="ansi-blue-fg">(market_code, keywords)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span> }
<span class="ansi-green-intense-fg ansi-bold">     27</span>   <span class="ansi-green-fg">async</span> <span class="ansi-green-fg">with</span> aiohttp<span class="ansi-blue-fg">.</span>ClientSession<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> session<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 28</span><span class="ansi-red-fg">       </span><span class="ansi-green-fg">async</span> <span class="ansi-green-fg">with</span> session<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>search_url<span class="ansi-blue-fg">,</span> headers<span class="ansi-blue-fg">=</span>headers<span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">=</span>params<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> response<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     29</span>           <span class="ansi-green-fg">return</span> <span class="ansi-green-fg">await</span> pd<span class="ansi-blue-fg">.</span>DataFrame<span class="ansi-blue-fg">.</span>from_dict<span class="ansi-blue-fg">(</span>response<span class="ansi-blue-fg">.</span>json<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;value&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;name&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;url&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;datePublished&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/client.py</span> in <span class="ansi-cyan-fg">__aenter__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">   1115</span> 
<span class="ansi-green-intense-fg ansi-bold">   1116</span>     <span class="ansi-green-fg">async</span> <span class="ansi-green-fg">def</span> __aenter__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> _RetType<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 1117</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_resp <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> self<span class="ansi-blue-fg">.</span>_coro
<span class="ansi-green-intense-fg ansi-bold">   1118</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_resp
<span class="ansi-green-intense-fg ansi-bold">   1119</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/client.py</span> in <span class="ansi-cyan-fg">_request</span><span class="ansi-blue-fg">(self, method, str_or_url, params, data, json, cookies, headers, skip_auto_headers, auth, allow_redirects, max_redirects, compress, chunked, expect100, raise_for_status, read_until_eof, proxy, proxy_auth, timeout, verify_ssl, fingerprint, ssl_context, ssl, proxy_headers, trace_request_ctx, read_bufsize)</span>
<span class="ansi-green-intense-fg ansi-bold">    540</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    541</span>                         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 542</span><span class="ansi-red-fg">                             </span>resp <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">await</span> req<span class="ansi-blue-fg">.</span>send<span class="ansi-blue-fg">(</span>conn<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    543</span>                             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    544</span>                                 <span class="ansi-green-fg">await</span> resp<span class="ansi-blue-fg">.</span>start<span class="ansi-blue-fg">(</span>conn<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/client_reqrep.py</span> in <span class="ansi-cyan-fg">send</span><span class="ansi-blue-fg">(self, conn)</span>
<span class="ansi-green-intense-fg ansi-bold">    666</span>             self<span class="ansi-blue-fg">.</span>method<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>version
<span class="ansi-green-intense-fg ansi-bold">    667</span>         )
<span class="ansi-green-fg">--&gt; 668</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">await</span> writer<span class="ansi-blue-fg">.</span>write_headers<span class="ansi-blue-fg">(</span>status_line<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>headers<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    669</span> 
<span class="ansi-green-intense-fg ansi-bold">    670</span>         self<span class="ansi-blue-fg">.</span>_writer <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>loop<span class="ansi-blue-fg">.</span>create_task<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>write_bytes<span class="ansi-blue-fg">(</span>writer<span class="ansi-blue-fg">,</span> conn<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/http_writer.py</span> in <span class="ansi-cyan-fg">write_headers</span><span class="ansi-blue-fg">(self, status_line, headers)</span>
<span class="ansi-green-intense-fg ansi-bold">    116</span>         <span class="ansi-blue-fg">&#34;&#34;&#34;Write request/response status and headers.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    117</span>         <span class="ansi-red-fg"># status + headers</span>
<span class="ansi-green-fg">--&gt; 118</span><span class="ansi-red-fg">         </span>buf <span class="ansi-blue-fg">=</span> _serialize_headers<span class="ansi-blue-fg">(</span>status_line<span class="ansi-blue-fg">,</span> headers<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    119</span>         self<span class="ansi-blue-fg">.</span>_write<span class="ansi-blue-fg">(</span>buf<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    120</span> 

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/_http_writer.pyx</span> in <span class="ansi-cyan-fg">aiohttp._http_writer._serialize_headers</span><span class="ansi-blue-fg">()</span>

<span class="ansi-green-fg">/usr/local/lib/python3.7/dist-packages/aiohttp/_http_writer.pyx</span> in <span class="ansi-cyan-fg">aiohttp._http_writer.to_str</span><span class="ansi-blue-fg">()</span>

<span class="ansi-red-fg">TypeError</span>: Cannot serialize non-str key None</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">aiohttp</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">get_pokemon</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">:</span>
        <span class="n">pokemon</span> <span class="o">=</span> <span class="k">await</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">pokemon</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>

        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">151</span><span class="p">):</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://pokeapi.co/api/v2/pokemon/</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">get_pokemon</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">)))</span>

        <span class="n">original_pokemon</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pokemon</span> <span class="ow">in</span> <span class="n">original_pokemon</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">pokemon</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- </span><span class="si">%s</span><span class="s2"> seconds ---&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-86-3b7a977ec65f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     25</span>             print<span class="ansi-blue-fg">(</span>pokemon<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span> 
<span class="ansi-green-fg">---&gt; 27</span><span class="ansi-red-fg"> </span>asyncio<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>main<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;--- %s seconds ---&#34;</span> <span class="ansi-blue-fg">%</span> <span class="ansi-blue-fg">(</span>time<span class="ansi-blue-fg">.</span>time<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> start_time<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/lib/python3.7/asyncio/runners.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(main, debug)</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span>     <span class="ansi-green-fg">if</span> events<span class="ansi-blue-fg">.</span>_get_running_loop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span>         raise RuntimeError(
<span class="ansi-green-fg">---&gt; 34</span><span class="ansi-red-fg">             &#34;asyncio.run() cannot be called from a running event loop&#34;)
</span><span class="ansi-green-intense-fg ansi-bold">     35</span> 
<span class="ansi-green-intense-fg ansi-bold">     36</span>     <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> coroutines<span class="ansi-blue-fg">.</span>iscoroutine<span class="ansi-blue-fg">(</span>main<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">RuntimeError</span>: asyncio.run() cannot be called from a running event loop</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Why-is-this-so-much-faster?">Why is this so much faster?<a class="anchor-link" href="#Why-is-this-so-much-faster?"> </a></h1><p>In the first version of this code, there was a single event loop which first did 35 queries one after the other, so the next request would only be sent of the previous one was finished. After that all the entries were translated, which are 10 <em> 35 </em> 2 = 700 calls one after the other. shuffling the order around would not have made this any faster.
When using async, all 35 request were dispatched and serviced simultaneously, and for each request when the server responded, the 10 * 2 entries were immediately translated simultaneously as well.
With the inclusion of the backoff package, connecting this to async requests and their logging system, by adding just 10 lines of code we made our code 10 times faster, more reliably and easier to maintain down the line.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/blog/2021/05/30/Worldwide_news_fast_with_async.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
